# Wallet API

API для управления кошельками, позволяющий отправлять средства, просматривать баланс и получать историю транзакций.

## Запуск

Для запуска приложения необходимо выполнить следующие команды:

1. `cd deploy`
2. `docker compose up`

При первом запуске создастся база данных, а в таблицу `wallet`, храняющую кошельки будет внесены 10 записей со случайными адресами и балансом 100

Для просмотра списка кошельков необходимо зайти в контейнер с базой данных и выполнить команды:

1. `psql -U root payment`, где root - имя пользователя БД. Имя пользователя и пароль для БД можно поменять в файле `./deploy/.env`
2. `select * from wallet;`


## Эндпоинты

### 1. Отправка средств

**POST** `/api/send`

Отправляет средства с одного кошелька на другой.

#### Параметры запроса

Тело запроса должно содержать JSON-объект со следующими полями:

```json
{
  "from": "sender_address",
  "to": "recipient_address",
  "amount": 3.50
}
```

- `from` (string) - адрес кошелька-отправителя
- `to` (string) - адрес кошелька-получателя  
- `amount` (number) - сумма перевода

#### Ответы

- **200 OK** - транзакция успешно выполнена
- **400 Bad Request** - недостаточно средств на кошельке или некорректные данные
- **404 Not Found** - кошелек с предоставленным адресом не найден
- **500 Internal Server Error** - внутренняя ошибка сервера

#### Пример запроса

```bash
curl -X POST http://localhost:8080/api/send \
  -H "Content-Type: application/json" \
  -d '{
    "from": "sender_address",
    "to": "recipient_address",
    "amount": 3.50
  }'
```

### 2. Получение истории транзакций

**GET** `/api/transactions?count=N`

Возвращает информацию о N последних транзакциях.

#### Параметры запроса

- `count` (query parameter) - количество возвращаемых транзакций

#### Ответы

- **200 OK** - возвращает массив с данными о транзакциях
- **400 Bad Request** - параметр count не предоставлен или имеет неверный формат
- **500 Internal Server Error** - внутренняя ошибка сервера

#### Пример запроса

```bash
curl "http://localhost:8080/api/transactions?count=10"
```

#### Пример ответа

```json
[
  {
    "from": "sender_address",
    "to": "recipient_address", 
    "amount": 3.50,
    "created_at": "2024-01-15T10:30:00Z"
  }
]
```

### 3. Получение баланса кошелька

**GET** `/api/wallet/{address}/balance`

Возвращает информацию о балансе указанного кошелька.

#### Параметры запроса

- `address` (path parameter) - адрес кошелька

#### Ответ

- **200 OK** - возвращает баланс кошелька
- **404 Bad Request** - кошелек с предоставленным адресом не найден
- **500 Internal Server Error** - внутренняя ошибка сервера

#### Пример запроса

```bash
curl "http://localhost:8080/api/wallet/e240d825d255af751f5f55af8d9671beabdf2236c0a3b4e2639b3e182d994c88e/balance"
```

#### Пример ответа

```json
{
  "balance": 150.75
}
```

## Обработка ошибок

API возвращает читаемые сообщения об ошибках с соответствующими HTTP статус-кодами:

- **400 Bad Request** - при недостаточном балансе или некорректных параметрах
- **404 Not Found** - при обращении к несуществующему кошельку
- **500 Internal Server Error** - внутренняя ошибка сервера

Пример ответа с ошибкой:

```json
{
  "error": "wallet with provided address does not exist",
}
```